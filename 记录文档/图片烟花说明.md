# 图片烟花功能说明

## 功能介绍
新增了一种特殊的烟花类型：**图片烟花**，可以在空中展示图片，实现图片从中心扩散放大的动画效果。

## 使用方法

### 按键绑定
- **按 I 键**：发射图片烟花（默认显示鱼的图片）

### 效果描述
1. 烟花升空，到达爆炸点
2. 图片从中心点展开，每个像素作为一个粒子
3. 粒子从中心向外扩散，保持图片形状，实现放大效果
4. 持续2秒后粒子逐渐消失

## 技术实现

### 文件修改
1. **FireworkParticleSystem.h**
   - 添加 `FireworkType::Image` 枚举
   - 添加 `ImageData` 结构体用于存储图片数据
   - 在 `Particle` 结构中添加 `imageOffset` 字段
   - 声明 `generateImageParticles()` 和 `loadImage()` 方法

2. **FireworkParticleSystem.cpp**
   - 实现 `loadImage()` 方法：使用 stb_image 加载图片
   - 实现 `generateImageParticles()` 方法：
     - 采样图片像素（默认间隔3像素）
     - 跳过透明像素
     - 为每个像素创建粒子，保持原始颜色
     - 计算扩散速度，使粒子从中心向外运动
   - 修改 `createExplosion()` 支持 Image 类型
   - 图片烟花不进行二次爆炸

3. **InputHandler.cpp**
   - 添加 I 键绑定，发射图片烟花

### 图片资源
- 默认图片路径：`assets/firework_images/fish.png`
- 可以替换此路径的图片来显示不同内容

## 自定义配置

### 修改图片路径
在 [FireworkParticleSystem.cpp](d:\zlearning\project\Fireworks_OpenGL\Fireworks_OpenGL\src\FireworkParticleSystem.cpp) 的 `createExplosion()` 方法中修改：
```cpp
case FireworkType::Image:
    // 修改这里的路径来使用其他图片
    generateImageParticles(source.position, "assets/firework_images/your_image.png", 3);
    break;
```

### 参数调整
在 `generateImageParticles()` 方法中可以调整：
- `sampleRate`（默认3）：采样间隔，值越小粒子越多
- `expandSpeed`（默认3.0f）：扩散速度
- `p.life`（默认2.0f）：粒子持续时间（秒）
- `p.size`（默认 childSize * 1.5f）：粒子大小

### 添加新的图片烟花按键
在 InputHandler.cpp 中复制 I 键的代码并修改：
```cpp
// 新按键：J键显示另一张图片
static bool keyJPressed = false;
if (glfwGetKey(window, GLFW_KEY_J) == GLFW_PRESS && !keyJPressed) {
    glm::vec3 launchPos = glm::vec3(0.0f, 0.5f, 0.0f);
    fireworkSystem.launch(
        launchPos,
        FireworkParticleSystem::FireworkType::Image,
        1.5f,
        glm::vec4(1.0f, 1.0f, 1.0f, 1.0f),
        glm::vec4(1.0f, 1.0f, 1.0f, 1.0f),
        fireworkSystem.launcherSize);
    keyJPressed = true;
    std::cout << "[Image] Launch Another Image Firework!" << std::endl;
}
if (glfwGetKey(window, GLFW_KEY_J) == GLFW_RELEASE) keyJPressed = false;
```

然后在 FireworkParticleSystem 中添加支持多张图片的逻辑。

## 注意事项
1. 图片推荐使用 PNG 格式（支持透明通道）
2. 图片尺寸建议不要太大（200x200 以内），否则粒子数量会很多影响性能
3. 采样间隔越小，粒子越多，效果越清晰但性能消耗越大
4. 图片会自动缩放到适合的尺寸（默认6个单位）
5. 透明像素会被自动跳过，只显示有颜色的部分
